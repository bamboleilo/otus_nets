# **Введение в DHCPv4**

### **Задание**
1. Создание сети и конфигурирование базовых параметров устройств
2. Конфигурирование и проверка 2-х DHCP серверов на R1
3. Конфигурирование и проверка DHCP Relay на R2

### **Решение:**
Часть 1: Создание сети и конфигурирование базовых параметров устройств.
1. Создание макета в симуляторе Packettracert, таблицы адресации, настройка базовых параметров устройств, проверка работы.
2. Проверка связи.

Часть 2: Конфигурирование и проверка 2-х DHCP серверов на R1
1. Отключить все порты на коммутаторах.
2. Настройть подключенные порты в качестве транковых.
3. Включить порты F0/2 и F0/4 на всех коммутаторах.
4. Отобразить данные протокола spanning-tree.

Часть 3:	Конфигурирование и проверка DHCP Relay на R2
1. Определение коммутатора с заблокированным портом.
2. Изменение стоимости порта.
3. Просмотр изменения протокола spanning-tree.
4. Удалить изменения стоимости порта.


# **Часть 1: Создание сети и конфигурирование базовых параметров устройств**

### **1. Создание макета в эмуляторе EVE-NG, таблицы адресации, настройка базовых параметров устройств, проверка работы**

Схема в EVE-NG

![DHCPv4](https://github.com/bamboleilo/otus_nets/assets/39755453/ca418db8-2b46-4e4d-86af-8da813a4dd7c)

Таблица адресации

|  Устройство  | Интерфейс | IP-адрес      | Маска подсети   |
|--------------|-----------|---------------|-----------------|
| S1           | VLAN1     | 192.168.1.1   | 255.255.255.0   |
| S2           | VLAN1     | 192.168.1.2   | 255.255.255.0   |
| S3           | VLAN1     | 192.168.1.3   | 255.255.255.0   |
 
Пример настройки базовых параметров для S1

```
hostname S1
no ip domain-lookup
enable secret class
line vty 0 15
 password cisco
 login
 transport input all
banner motd #Authorized Access Only!#
int vlan 1
 no sh
 ip address 192.168.1.1 255.255.255.0
int ra fa0/1-24
 sh
int ra gi0/1-2
 sh
int ra fa0/1-4
 sw mode trunk
int ra fa0/2, fa0/4
 no sh
```
Аналогично проводим настройка и коммутаторами S2 и S3

### **2. Проверка связи.**

Проверяем эхо-запросы от коммутатора S1 на коммутаторы S2 и S3

![image](https://user-images.githubusercontent.com/39755453/110992848-5177b780-8398-11eb-8476-632701a03225.png)

Проверяем эхо-запросы от коммутатора S2 на коммутатор S3

![image](https://user-images.githubusercontent.com/39755453/110993139-b7643f00-8398-11eb-9767-a424bb4ac257.png)

# **Часть 2: Определение корневого моста**

### **1. Отключить все порты на коммутаторах**

Данные настройки приведены в базовых

### **2. Настройть подключенные порты в качестве транковых.**

Данные настройки приведены в базовых

### **3. Включить порты F0/2 и F0/4 на всех коммутаторах.**

Данные настройки приведены в базовых

### **4. Отобразить данные протокола spanning-tree.**

Данные настроек протокола spanning-tree на S1

![S1-stp](https://user-images.githubusercontent.com/39755453/111042347-c7deed00-845e-11eb-915e-37c807842869.png)

Данные настроек протокола spanning-tree на S2

![S2-stp](https://user-images.githubusercontent.com/39755453/111042355-d200eb80-845e-11eb-81cd-a103cdf529aa.png)

Данные настроек протокола spanning-tree на S3

![S3-stp](https://user-images.githubusercontent.com/39755453/111042393-ff4d9980-845e-11eb-8735-653a849154ca.png)

Исходя из настроек, видно, что коммутатор S2 выбран в качестве корневого, так как имеет наименьший mac-address. Порты на S2 fa0/2 и fa0/4 являются назначенными; порты на S1: fa0/2 - корневой (так как прямой порт в корневой коммутатор S2), fa0/4 - назначенный; порты на S3: fa0/2 - корневой (так как прямой порт в корневой корневой коммутатор S2), fa0/4 - альтернативный (выбран в качестве альтернативного, так как mac-address S1 имеет меньшее значение, чем на S3).


# **Часть 3:	Наблюдение за процессом выбора протоколом STP порта, исходя из стоимости портов**

### **1. Определение коммутатора с заблокированным портом.**

![S3-stp2](https://user-images.githubusercontent.com/39755453/111042475-6a976b80-845f-11eb-878c-eabe6c0e9c11.png)

### **2. Изменение стоимости порта.**

```
S3(config)# interface f0/2
S3(config-if)# spanning-tree vlan 1 cost 18
```

### **3. Просмотр изменения протокола spanning-tree.**

![stp-cost](https://user-images.githubusercontent.com/39755453/111067207-015a3b80-84e5-11eb-9940-a7c56a694168.png)

![image](https://user-images.githubusercontent.com/39755453/111067232-26e74500-84e5-11eb-843f-4a0140ca2819.png)

### **4. Удалить изменения стоимости порта.**

```
S3(config)# interface f0/2
S3(config-if)# no spanning-tree vlan 1 cost 18
```

# **Часть 4:	Наблюдение за процессом выбора протоколом STP порта, исходя из приоритета портов**

Включаем порты fa0/1 и fa0/3 на всех коммутаторах.
Примен настройки на S1:

```
S1(config)# interface range fa0/1, fa0/3
S1(config-if)# no sh
```
Просматриваем изменения топологии STP:

![stp-s1-change-topology](https://user-images.githubusercontent.com/39755453/111067881-14bad600-84e8-11eb-8367-418be98bceff.png)

![stp-s3-change-topology](https://user-images.githubusercontent.com/39755453/111067883-1a182080-84e8-11eb-9527-669c0ddf4ab0.png)

Как мы видим порт корневого моста переместился на порт с меньшим номером, связанный с коммутатором корневого моста, и заблокировал предыдущий порт корневого моста.

Все файлы конфигураций приведены [здесь](configs/)
